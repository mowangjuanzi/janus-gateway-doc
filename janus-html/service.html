<p>By default, Janus starts in foreground, and as such works as a server application that you start normally and displays output on the console. That said, there are several reasons why you may not want to keep Janus in the foreground, while still being interested in checking the console to see what's happening.</p>
<p>There are different ways to "daemonize" it and have it run as a service, though. This page tries to summarize a few ways to do so, starting from "dumb" approaches like sending to background and/or using screen/tmux, to more sophisticated approaches involving <code>systemd</code>, <code>upstart</code> and others.</p>
<h1 class="doxsection"><a class="anchor" id="daemon"></a>
Running Janus as a daemon</h1>
<p>Since version <code>0.1.0</code>, you can run Janus as a daemon application. To do so, just pass either <code>-b</code> or <code>--daemon</code> as a command line argument, and Janus will be daemonized. Just beware, though, that since this results in stdout/stdin/stderr being closed, you MUST specify a log file for Janus to use, either via command line (<code>-L</code> or <code>--log-file</code> ) or in <code>janus.jcfg</code>.</p>
<h1 class="doxsection"><a class="anchor" id="bg"></a>
Running in background</h1>
<p>Another simple way to run Janus in the background is to just append the <code>&amp;</code> character to the command line. Anyway, this will still "flood" the console with output from Janus. While there are ways to handle it (e.g., as explained <a href="http://www.thegeekstuff.com/2010/05/unix-background-job/">here</a>), a nice and easy way to handle this is redirecting the output to a separate file, e.g., a dedicated log:</p>
<pre class="fragment">/opt/janus/bin/janus -d 5 -6 &gt;/path/to/mylogfile 2&gt;&amp;1 &amp;
</pre><p>This is especially useful in case you want to keep a log of what happened when Janus was running, and can also be used as a simple and effective way to watch the console "live" using <code>tail:</code> </p><pre class="fragment">tail -f /path/to/mylogfile
</pre><h1 class="doxsection"><a class="anchor" id="screen"></a>
Terminal multiplexers</h1>
<p>Another easy way to run Janus in the background is using terminal multiplexers like <code>screen</code> or <code>tmux</code>. If you're not familiar with such applications, you can find a quick overview <a href="https://en.wikipedia.org/wiki/Terminal_multiplexer">here</a>.</p>
<p>The following is a simple example with <code>screen:</code> </p>
<pre class="fragment">screen -S janus -d -m
screen -r janus -X stuff $'/opt/janus/bin/janus -d 5 -6\n'
</pre><p>This will create a session called "janus" and launch Janus in it with a few command line options (in this case, just the option to enable IPv6 support and set the debug to verbose). Janus will then be running in the background: accessing the console is just a matter of attaching to the "janus" screen:</p>
<pre class="fragment">screen -r janus
[CTRL+A+D to detach again]
</pre><p>Terminal multiplexers usually allow for logging the output to file as well, if you want to keep an history of what happened during the Janus lifetime.</p>
<h1 class="doxsection"><a class="anchor" id="systemd"></a>
systemd</h1>
<p>This section shows how you can add Janus as a service to <a href="https://en.wikipedia.org/wiki/Systemd">systemd</a>.</p>
<pre class="fragment">[Unit]
Description=Janus WebRTC Server
After=network-online.target
Wants=network-online.target

[Service]
Type=simple
ExecStart=/opt/janus/bin/janus -o
Restart=on-abnormal
LimitNOFILE=65536

[Install]
WantedBy=multi-user.target
</pre><dl class="section note"><dt>Note</dt><dd>Remember to adjust the path in ExecStart to match the Janus binary path.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Please beware that, per the default <code>RateLimitInterval</code> and and <code>RateLimitBurst</code> values in the default systemd configuration, logger messages are dropped if they arrive faster than ~33 per second. You may want to configure them accordingly, or otherwise Janus log messages may be missing. To fix this, setting <code>RateLimitInterval=1s</code> and <code>RateLimitBurst=2000</code> in <code>/etc/systemd/journald.conf</code> is usually enough.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>systemd example provided by <a href="https://github.com/meetecho/janus-gateway/pull/306">@saghul</a></dd></dl>
<h1 class="doxsection"><a class="anchor" id="upstart"></a>
upstart</h1>
<p>This section shows how you can add Janus as a daemon to <a href="http://upstart.ubuntu.com/">upstart</a>, which is typically available on Ubuntu systems.</p>
<pre class="fragment">description "janus"

start on filesystem or runlevel [2345]
stop on runlevel [!2345]
limit nofile 50000 50000
limit core unlimited unlimited

respawn
respawn limit 10 5

exec /opt/janus/bin/janus
</pre><dl class="section note"><dt>Note</dt><dd>upstart example provided by <a href="https://github.com/meetecho/janus-gateway/pull/306">@ploxiln</a></dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>In case starting Janus depends on some external conditions, you may need to modify the <code>start</code> and <code>stop</code> lines accordingly. Here you can find an <a href="https://github.com/meetecho/janus-gateway/pull/455">example</a>, provided by <a href="https://github.com/meetecho/janus-gateway/pull/455">@stormbkk87</a>, showing how you can wait, for instance, for RabbitMQ to start before starting Janus too.</dd></dl>
<h1 class="doxsection"><a class="anchor" id="sysvinit"></a>
sysvinit</h1>
<p>This section shows how you can add Janus as a daemon to SysVinit based systems.</p>
<pre class="fragment">#!/bin/sh

### BEGIN INIT INFO
# Provides:          Janus
# Required-Start:    $remote_fs $syslog
# Required-Stop:     $remote_fs $syslog
# Default-Start:     2 3 4 5
# Default-Stop:      0 1 6
# Short-Description: Janus WebRTC Server
# Description:       Janus WebRTC Server
### END INIT INFO

DAEMON=/usr/bin/janus
DAEMON_NAME=janus

# Add any command line options for your daemon here
DAEMON_OPTS="-D -o"

# This next line determines what user the script runs as.
# Root generally not recommended but necessary if you are using the Raspberry Pi GPIO from Python.
DAEMON_USER=root

# The process ID of the script when it runs is stored here:
PIDFILE=/var/run/$DAEMON_NAME.pid

. /lib/lsb/init-functions

do_start () {
    log_daemon_msg "Starting system $DAEMON_NAME daemon"
    start-stop-daemon --start --background --no-close --pidfile $PIDFILE --make-pidfile --user $DAEMON_USER --chuid $DAEMON_USER --startas $DAEMON -- $DAEMON_OPTS &gt;&gt; /var/log/$DAEMON_NAME.log 2&gt;&amp;1
    log_end_msg $?
}
do_stop () {
    log_daemon_msg "Stopping system $DAEMON_NAME daemon"
    start-stop-daemon --stop --pidfile $PIDFILE --retry 10
    log_end_msg $?
}

case "$1" in

    start|stop)
        do_${1}
        ;;

    restart|reload|force-reload)
        do_stop
        do_start
        ;;

    status)
        status_of_proc "$DAEMON_NAME" "$DAEMON" &amp;&amp; exit 0 || exit $?
        ;;

    *)
        echo "Usage: /etc/init.d/$DAEMON_NAME {start|stop|restart|status}"
        exit 1
        ;;

esac
exit 0
</pre><dl class="section note"><dt>Note</dt><dd>sysvinit example provided by <a href="https://github.com/saghul">@saghul</a></dd></dl>
<h1 class="doxsection"><a class="anchor" id="supervisor"></a>
supervisor</h1>
<p>This section shows how you can add Janus to <a href="http://supervisord.org/">supervisor</a>, which is typically available on Ubuntu systems.</p>
<pre class="fragment">[program:janus]
command=/opt/janus/bin/janus
user=root
autostart=true
autorestart=true
stderr_logfile=/var/log/janus.err.log
stdout_logfile=/var/log/janus.out.log
</pre><dl class="section note"><dt>Note</dt><dd>The above configuration file should be added to <code>/etc/supervisor/conf.d/janus.conf</code>. Then the following commands should be run:</dd></dl>
<pre class="fragment">sudo supervisorctl reread
sudo supervisorctl update
</pre><h1 class="doxsection"><a class="anchor" id="Others"></a>
Others</h1>
<p>TODO. </p>
